sudo: required
language: c
env:
  matrix:
# Xiaomi Mi5
    - ndevicechoice="0"
      ntoolchain="42"
    - ndevicechoice="0"
      ntoolchain="46"
    - ndevicechoice="0"
      ntoolchain="47"
    - ndevicechoice="0"
      ntoolchain="49"
# Xiaomi Mi5S
    - ndevicechoice="1"
      ntoolchain="42"
    - ndevicechoice="1"
      ntoolchain="46"
    - ndevicechoice="1"
      ntoolchain="47"
    - ndevicechoice="1"
      ntoolchain="49"
# Xiaomi Mi5S Plus
    - ndevicechoice="2"
      ntoolchain="42"
    - ndevicechoice="2"
      ntoolchain="46"
    - ndevicechoice="2"
      ntoolchain="47"
    - ndevicechoice="2"
      ntoolchain="49"
# Xiaomi Mi Mix
    - ndevicechoice="3"
      ntoolchain="42"
    - ndevicechoice="3"
      ntoolchain="46"
    - ndevicechoice="3"
      ntoolchain="47"
    - ndevicechoice="3"
      ntoolchain="49"
# Xiaomi Mi Note 2
    - ndevicechoice="4"
      ntoolchain="42"
    - ndevicechoice="4"
      ntoolchain="46"
    - ndevicechoice="4"
      ntoolchain="47"
    - ndevicechoice="4"
      ntoolchain="49"
script:
# The build.sh need LZ4 and ubuntu 12.xx not support 'LZ4' officialy
- sudo add-apt-repository ppa:nathan-renniewaldock/ppa -y
- sudo apt-get update
#
# Travis CI Script by Jonas Cardoso aka JonasCardoso <jonascard60@gmail.com>
# Toolchain 
- export ntoolchainbranch="master"
- git clone --depth=50 -b "${ntoolchainbranch}" "https://bitbucket.org/jonascardoso/toolchain_aarch64" "../Toolchain"
#
# This will call build.sh with following parameters inside ${nbasebuildsh}:
#
# 'export ndevicechoice="#"'
# 'export nbasebuildsh="${ndevice}${ndevicechoice}${ntoolchain}${nbuild}q""'
# 'source build.sh <<< "${nbasebuildsh}"'
# 'export zipfile#="${zipfile}"'
#
# ${nclean} = Clean zip "1" and "2" is "Clean Kernel" 
- nclean="12"
# "o" is to disable/enable output when building kernel
- noutput="o"
# "3" is "Device Choice"
#- ndevice="3"
# ${ntoolchain} = "4" is "Toolchain Choice", "7" is your Toolchain Choice Google
#- ntoolchain="47"
# ${nbuild} = "5" is "Build Kernel" and "6" is "Zip the kernel and Modules"
- nbuild="56"
# ${nimage} = "7" is "Compressed image on/off"
- nimage="7"
# Last "q" is to Exit of Script
# ${ndevicechoice} is "Number of Choice under Device Choice"
- export nbasebuildsh="${nclean}${ntoolchain}${ndevice}${ndevicechoice}${nimage}${nbuild}q"
- source build.sh <<< "${nbasebuildsh}"
- export zipfile0="${zipfile}"
before_deploy:
# Set up git user name and tag this commit
- git config --local user.name "jonascardoso"
- git config --local user.email "jonascard60@gmail.com"
- git tag "${customkernel}-$(date +'%d/%m/%Y')-HMP" --force
#  - git tag "$(date +'%d/%m/%Y')-$(git log --format=%h -1)"
#  - git tag "$(date +'%d/%m/%Y-%Hh%Mm%Ss')-$(git log --format=%h -1)"
deploy:
  overwrite: true
  provider: releases
  skip_cleanup: true
  api_key:
    secure: dCdpfLwT6QPbb3/jpaOrZFGBQ7uuXfc6zDZ7EipoSayu1mCXZf+QWk7Xo/j5kZYtTpc7Fes+6/sd95aQfHbEy3o/jVpT6E+3F0SY5nmaSU5wPK+CShjYvsP04tNwOer5TKvmv6kZMOKyvtF1/3SB2F5Dk/lOHKzM1gCngNNckNdhAkAam53RVwOGpYr7vHAtziGB8PlEhahBow0/J5tZOrU7GS1uFsUqWtvWeMwYTuydgS5ThDcLQnNIkbvqXq2bTCZxcBFNnL9NGw3gdObiU5PtpQbnFOwLES3peIzwVMOKImJC3byCq7zbeNDVPyQ+7fToWGKPcTApwwEKTLpyqcu2yzTeslyhTSrNVMWc69btINDEgYLq3m/5m/ceQ7fLjmZo+10zeBHW4QAH4ilK4rFspwNaPOOwy9Boe8QDTpFshVuWMEtCj7fXWD57FbPWzhN6BuHq77SlT7EFLqnb4UL/9DBdgtQ8VrVSOrtBrD4bXM93FXHd9VuGyimqjndzUpcy+bA4Tgi59+JbDmfMvEt+H+vUMkFkHf6CjYxl23rdl0W13igcccG4PfKNePBdGexOVCG7j4hflelYdayPoDo8PuxXHhNzV9TiFXr2tLE5wKP06YH9fqFHRdjzqIySX1B9YfPJ7/BlzQLaTt94KnCOU9qb7DsbycNO45+6bsU=
  file:
    - "zip-creator/${zipfile0}"
  on:
    repo: JonasCardoso/android_kernel_xiaomi_msm8996
    branch: cm-14.1

